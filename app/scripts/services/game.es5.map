{"version":3,"sources":["game.js"],"names":[],"mappings":"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","file":"game.es5","sourcesContent":["'use strict';\n\n/**\n * @ngdoc service\n * @name fcApp.Game\n * @description\n * # Game\n * Service in the fcApp.\n */\nangular.module('fcApp')\n  .factory('Game', ($q, lodash, Players) => {\n    const numbers = lodash.range(0, 13);\n    let service = {\n      revealed: [],\n      cards: [],\n      stateMachine: {\n        start: 'setup',\n        setup: 'bet',\n        bet: 'turn',\n        turn: ['bet', 'end'],\n        end: 'start'\n      },\n      turnBet: []\n    };\n\n    service.reset = () => {\n      service.state = 'setup';\n      service.cards = lodash.union(\n        lodash.map(numbers, (n) => { return { value: n, type: 'S' }; }),\n        lodash.map(numbers, (n) => { return { value: n, type: 'D' }; }),\n        lodash.map(numbers, (n) => { return { value: n, type: 'F' }; }),\n        lodash.map(numbers, (n) => { return { value: n, type: 'H' }; })\n      );\n    };\n\n    service.addPlayer = (ps) => Players.addPlayer(ps);\n\n    service.findPlayer = (id) => Players.find(id);\n\n    service.getCards = () => service.cards;\n\n    service.getRevealedCards = () => service.revealed;\n\n    service.addBet = (p) => {\n      service.turnBet.push(p);\n      if (service.turnBet.length > 1) {\n        service.bet(service.turnBet[0], service.turnBet[1]);\n        service.turnBet = [];\n      }\n    };\n\n    service.bet = (p1, p2) => {\n      Players.bet(p1, p2);\n      service.revealCards(1);\n    };\n\n    service.giveCards = () => {\n      if (service.cards.length < 4) { return; }\n      service.cards = lodash.shuffle(service.cards);\n      Players.giveCards(lodash.pullAt(service.cards, [0, 1, 2, 3]));\n      service.revealCards(3);\n      service.state = 'bet';\n    };\n\n    service.revealCards = (n) => {\n      service.cards = lodash.shuffle(service.cards);\n      var newCards = lodash.pullAt(service.cards, lodash.range(n));\n      service.revealed = lodash.union(service.revealed, newCards);\n    };\n\n    return service;\n  });\n"]}